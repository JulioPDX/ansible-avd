
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Arista Validated Design collection's documentation">
      
      
        <meta name="author" content="Arista Ansible Team">
      
      
      <link rel="icon" href="../_media/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.1, mkdocs-material-8.5.7">
    
    
      
        <title>Build your first AVD & CVP project - Arista AVD collection</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.material.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installation-process" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Arista AVD collection" class="md-header__button md-logo" aria-label="Arista AVD collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Arista AVD collection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Build your first AVD & CVP project
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aristanetworks/ansible-avd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    AVD on Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Arista AVD collection" class="md-nav__button md-logo" aria-label="Arista AVD collection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>

    </a>
    Arista AVD collection
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aristanetworks/ansible-avd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    AVD on Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release Notes" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/3.x.x.html" class="md-nav__link">
        3.x.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/2.x.x.html" class="md-nav__link">
        2.x.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/1.1.x.html" class="md-nav__link">
        1.1.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/1.0.x.html" class="md-nav__link">
        1.0.x
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting-started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/collection-installation.html" class="md-nav__link">
        Collection Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/requirements.html" class="md-nav__link">
        Requirements
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          How-To
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How-To" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          How-To
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="first-project.html" class="md-nav__link">
        Build your first AVD project
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Build your first AVD & CVP project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="first-cvp-avd-project.html" class="md-nav__link md-nav__link--active">
        Build your first AVD & CVP project
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-process" class="md-nav__link">
    Installation Process
  </a>
  
    <nav class="md-nav" aria-label="Installation Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demonstration-requirements" class="md-nav__link">
    Demonstration requirements
  </a>
  
    <nav class="md-nav" aria-label="Demonstration requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-address-management" class="md-nav__link">
    IP Address management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-python-environment" class="md-nav__link">
    Configure Python environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-dhcp-server-on-cloudvision" class="md-nav__link">
    Configure DHCP server on CloudVision
  </a>
  
    <nav class="md-nav" aria-label="Configure DHCP server on CloudVision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible-playbook-approach" class="md-nav__link">
    Ansible playbook approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-approach" class="md-nav__link">
    Manual approach
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-inventory" class="md-nav__link">
    Update Inventory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-fabric-information" class="md-nav__link">
    Update Fabric information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-script" class="md-nav__link">
    Demo script
  </a>
  
    <nav class="md-nav" aria-label="Demo script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-up-devices" class="md-nav__link">
    Power up devices
  </a>
  
    <nav class="md-nav" aria-label="Power up devices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-there-is-no-container" class="md-nav__link">
    Check there is no container
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-configlets-are-not-present" class="md-nav__link">
    Check Configlets are not present
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-custom-configlets-to-cloudvision" class="md-nav__link">
    Upload custom configlets to Cloudvision.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-ansible-playbook-to-rollout-evpn-fabric" class="md-nav__link">
    Run Ansible playbook to rollout EVPN Fabric
  </a>
  
    <nav class="md-nav" aria-label="Run Ansible playbook to rollout EVPN Fabric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playbook-overview" class="md-nav__link">
    Playbook overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-playbook" class="md-nav__link">
    Run Playbook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-eos-configuration" class="md-nav__link">
    Generate EOS Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provision-cloudvision-server" class="md-nav__link">
    Provision CloudVision Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-pending-tasks-using-a-change-control" class="md-nav__link">
    Execute Pending tasks using a change control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analyze-result" class="md-nav__link">
    Analyze result
  </a>
  
    <nav class="md-nav" aria-label="Analyze result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topology-update" class="md-nav__link">
    Topology Update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configlet-list" class="md-nav__link">
    Configlet list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-device-status" class="md-nav__link">
    Check device status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgp-status" class="md-nav__link">
    BGP Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vxlan-address-table" class="md-nav__link">
    VXLAN address table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-device-connectivity" class="md-nav__link">
    Check device connectivity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revert-topology" class="md-nav__link">
    Revert topology
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="lab-with-nat.html" class="md-nav__link">
        Use NAT to access eAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tower-integration.html" class="md-nav__link">
        AWX & Tower Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ztp.html" class="md-nav__link">
        Configure ZTP server with CV collection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="vscode-container.html" class="md-nav__link">
        VScode Container
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Roles documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Roles documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Roles documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_1" type="checkbox" id="__nav_6_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_1">
          eos_designs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="eos_designs" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_1">
          <span class="md-nav__icon md-icon"></span>
          eos_designs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/connected-endpoints.html" class="md-nav__link">
        Connected Endpoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/l3-edge.html" class="md-nav__link">
        DCI & L3 Edge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-topology.html" class="md-nav__link">
        Fabric Topology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/fabric-variables.html" class="md-nav__link">
        Fabric Variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/management-settings.html" class="md-nav__link">
        Management Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/network-services.html" class="md-nav__link">
        Network Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/node-types.html" class="md-nav__link">
        Node types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/platform-settings.html" class="md-nav__link">
        Platform Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_designs/doc/custom-structured-configuration.html" class="md-nav__link">
        Custom Structured Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_cli_config_gen/index.html" class="md-nav__link">
        eos_cli_config_gen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/cvp_configlet_upload/index.html" class="md-nav__link">
        cvp_configlet_upload
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_config_deploy_cvp/index.html" class="md-nav__link">
        eos_config_deploy_cvp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_config_deploy_eapi/index.html" class="md-nav__link">
        eos_config_deploy_eapi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_validate_state/index.html" class="md-nav__link">
        eos_validate_state
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/eos_snapshot/index.html" class="md-nav__link">
        eos_snapshot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/dhcp_provisioner/index.html" class="md-nav__link">
        dhcp_provisioner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roles/build_output_folders/index.html" class="md-nav__link">
        build_output_folders
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Modules documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Modules documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Modules documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/inventory_to_container.rst.html" class="md-nav__link">
        Module Inventory to containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/configlet_build_config.rst.html" class="md-nav__link">
        Module Configlet Build configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/index.html" class="md-nav__link">
        AVD Plugins & Filters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://cvp.avd.sh/" class="md-nav__link">
        Cloudvision Module documentation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Contributing to AVD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing to AVD" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Contributing to AVD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/setup-environment.html" class="md-nav__link">
        Setup environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/setup-git.html" class="md-nav__link">
        Git installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/getting-started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/style-guide.html" class="md-nav__link">
        Code Style
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contribution/development.html" class="md-nav__link">
        Development tips & tricks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          External resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="External resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          External resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html" class="md-nav__link">
        Ansible collection user guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.ansible.com/ansible/latest/user_guide/index.html" class="md-nav__link">
        Ansible User guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://galaxy.ansible.com/arista/avd" class="md-nav__link">
        Ansible Galaxy page
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://cvp.avd.sh/en/latest/" class="md-nav__link">
        Arista CVP Collection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/arista-netdevops-community/avd-install" class="md-nav__link">
        Arista Installation Script
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://aristanetworks.github.io/netdevops-examples/" class="md-nav__link">
        Arista Netdevops Community
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation-process" class="md-nav__link">
    Installation Process
  </a>
  
    <nav class="md-nav" aria-label="Installation Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demonstration-requirements" class="md-nav__link">
    Demonstration requirements
  </a>
  
    <nav class="md-nav" aria-label="Demonstration requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-address-management" class="md-nav__link">
    IP Address management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-python-environment" class="md-nav__link">
    Configure Python environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-dhcp-server-on-cloudvision" class="md-nav__link">
    Configure DHCP server on CloudVision
  </a>
  
    <nav class="md-nav" aria-label="Configure DHCP server on CloudVision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible-playbook-approach" class="md-nav__link">
    Ansible playbook approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-approach" class="md-nav__link">
    Manual approach
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-inventory" class="md-nav__link">
    Update Inventory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-fabric-information" class="md-nav__link">
    Update Fabric information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-script" class="md-nav__link">
    Demo script
  </a>
  
    <nav class="md-nav" aria-label="Demo script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#power-up-devices" class="md-nav__link">
    Power up devices
  </a>
  
    <nav class="md-nav" aria-label="Power up devices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-there-is-no-container" class="md-nav__link">
    Check there is no container
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-configlets-are-not-present" class="md-nav__link">
    Check Configlets are not present
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-custom-configlets-to-cloudvision" class="md-nav__link">
    Upload custom configlets to Cloudvision.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-ansible-playbook-to-rollout-evpn-fabric" class="md-nav__link">
    Run Ansible playbook to rollout EVPN Fabric
  </a>
  
    <nav class="md-nav" aria-label="Run Ansible playbook to rollout EVPN Fabric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#playbook-overview" class="md-nav__link">
    Playbook overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-playbook" class="md-nav__link">
    Run Playbook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-eos-configuration" class="md-nav__link">
    Generate EOS Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provision-cloudvision-server" class="md-nav__link">
    Provision CloudVision Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute-pending-tasks-using-a-change-control" class="md-nav__link">
    Execute Pending tasks using a change control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analyze-result" class="md-nav__link">
    Analyze result
  </a>
  
    <nav class="md-nav" aria-label="Analyze result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topology-update" class="md-nav__link">
    Topology Update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configlet-list" class="md-nav__link">
    Configlet list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-device-status" class="md-nav__link">
    Check device status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgp-status" class="md-nav__link">
    BGP Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vxlan-address-table" class="md-nav__link">
    VXLAN address table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-device-connectivity" class="md-nav__link">
    Check device connectivity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revert-topology" class="md-nav__link">
    Revert topology
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/aristanetworks/ansible-avd/edit/master/docs/docs/how-to/first-cvp-avd-project.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Build your first AVD & CVP project</h1>

<p>This document explain how to customize demo information and how to setup this environment. A complete git repository is available and can be used as a support to this how-to document.</p>
<p><strong>Demo repository:</strong> <a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo">arista-netdevops-community/ansible-avd-cloudvision-demo</a></p>
<h4 id="installation-process">Installation Process<a class="headerlink" href="#installation-process" title="Permanent link">&para;</a></h4>
<h5 id="demonstration-requirements">Demonstration requirements<a class="headerlink" href="#demonstration-requirements" title="Permanent link">&para;</a></h5>
<h6 id="components">Components<a class="headerlink" href="#components" title="Permanent link">&para;</a></h6>
<ul>
<li>A cloudVision server running version <code>&gt;= 2018.2.5</code></li>
<li>A network topology:
    - Demo is based on a 2 spines / 4 leafs running on GNS3 but should also be configured on EVE-NG platform.
    - Any physical or virtual topology with oob connected to CVP should work.</li>
<li>A python environmentwith CloudVision access.</li>
</ul>
<p><img alt="Lab Topology" src="../_media/first-cvp-avd-topology.png" /></p>
<h6 id="ip-address-management">IP Address management<a class="headerlink" href="#ip-address-management" title="Permanent link">&para;</a></h6>
<ul>
<li><strong><em>CloudVision IP address</em></strong>:
    - Cluster interface: eth0 / Should use your own IP address
    - Device interface: eth1 / <code>10.255.0.1/24</code></li>
<li><strong><em>Management Network</em></strong>: <code>10.255.0.0/24</code>
    - <em>DC1-SPINE1</em>: <code>10.255.0.11/24</code>
    - <em>DC1-SPINE2</em>: <code>10.255.0.12/24</code>
    - <em>DC1-LEAF1A</em>: <code>10.255.0.13/24</code>
    - <em>DC1-LEAF1B</em>: <code>10.255.0.14/24</code>
    - <em>DC1-LEAF2A</em>: <code>10.255.0.15/24</code>
    - <em>DC1-LEAF2B</em>: <code>10.255.0.16/24</code>
    - <em>DC1-L2LEAF1A</em>: <code>10.255.0.17/24</code>
    - <em>DC1-L2LEAF2B</em>: <code>10.255.0.18/24</code></li>
<li><strong><em>Default Username &amp; Password</em></strong>:
    - admin / arista123
    - cvpdamin / arista123
    - ansible / ansible</li>
<li><strong><em>Servers configuration</em></strong>:
    - Server 01: eth0 / <code>10.1.10.11/24</code>
    - Server 02: eth0 / <code>10.1.10.12/24</code></li>
</ul>
<p>This management IP addresses are used in a private virtual-network between CloudVision and Arista EOS devices.</p>
<h5 id="configure-python-environment">Configure Python environment<a class="headerlink" href="#configure-python-environment" title="Permanent link">&para;</a></h5>
<p>Please refer to <a href="../installation/collection-installation.html"><strong>installation page</strong></a> to install AVD and CVP collections.</p>
<h5 id="configure-dhcp-server-on-cloudvision">Configure DHCP server on CloudVision<a class="headerlink" href="#configure-dhcp-server-on-cloudvision" title="Permanent link">&para;</a></h5>
<p>In this scenario, we use CloudVision (CV) as ZTP server to provision devices and register them onto CV.</p>
<p>Once you get mac-address of your switches, edit file <code>/etc/dhcp/dhcpd.conf</code> in CloudVision. In this scenario, CV use following address to connect to devices: <code>10.255.0.1</code></p>
<p>If CVP has not been configured to activate ZTP services, it is highly recommended to follow <a href="https://www.arista.com/en/cg-cv/cv-dhcp-service-for-zero-touch-provisioning-ztp-setup">these steps</a></p>
<h6 id="ansible-playbook-approach">Ansible playbook approach<a class="headerlink" href="#ansible-playbook-approach" title="Permanent link">&para;</a></h6>
<p>An ansible playbook is available to configure CloudVision to act as a DHCP server for your lab:</p>
<ul>
<li>Edit variables in <strong><code>inventory/group_vars/CVP.yml</code></strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="nt">ztp</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">registration</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;http://10.255.0.1/ztp/bootstrap&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.3</span><span class="w"></span>
<span class="w">    </span><span class="nt">nameservers</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;10.255.0.3&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">general</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">subnets</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">network</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.0</span><span class="w"></span>
<span class="w">        </span><span class="nt">netmask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">255.255.255.0</span><span class="w"></span>
<span class="w">        </span><span class="nt">gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.3</span><span class="w"></span>
<span class="w">        </span><span class="nt">nameservers</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;10.255.0.3&#39;</span><span class="w"></span>
<span class="w">        </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.200</span><span class="w"></span>
<span class="w">        </span><span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.250</span><span class="w"></span>
<span class="w">        </span><span class="nt">lease_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span><span class="w"></span>
<span class="w">  </span><span class="nt">clients</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DC1-SPINE1</span><span class="w"></span>
<span class="w">      </span><span class="nt">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0c:1d:c0:1d:62:01&quot;</span><span class="w"></span>
<span class="w">      </span><span class="nt">ip4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.11</span><span class="w"></span>
</code></pre></div>
<blockquote>
<p>Please ensure to use quote to define your mac-address. Otherwise in some cases, ansible might consider them as HEX string.</p>
</blockquote>
<ul>
<li>Edit information related to ztp host in <strong><code>inventory/inventory.yml</code></strong></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">all</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">children</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">CVP</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">hosts</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">ztp</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="w">        </span><span class="nt">cvp</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_httpapi_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="p p-Indicator">[</span><span class="nv">...</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_httpapi_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Configuration to get Virtual Env information</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_python_interpreter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(which python)</span><span class="w"></span>
</code></pre></div>
<ul>
<li>Run playbook:</li>
</ul>
<div class="highlight"><pre><span></span><code>$ ansible-playbook playbooks/dc1-ztp-configuration.yml

PLAY <span class="o">[</span>Configure ZTP service on CloudVision<span class="o">]</span> *****************

TASK <span class="o">[</span>ztp-setup : Generate DHCPd configuration file<span class="o">]</span> ********
ok: <span class="o">[</span>ztp<span class="o">]</span>

TASK <span class="o">[</span>ztp-setup : Check <span class="p">&amp;</span> activate DHCP service on ztp<span class="o">]</span> *****
ok: <span class="o">[</span>ztp<span class="o">]</span>

TASK <span class="o">[</span>ztp-setup : Restart DHCP service on ztp<span class="o">]</span> **************
changed: <span class="o">[</span>ztp<span class="o">]</span>

PLAY RECAP **************************************************
ztp                        : <span class="nv">ok</span><span class="o">=</span><span class="m">3</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span>    <span class="nv">skipped</span><span class="o">=</span><span class="m">0</span>    <span class="nv">rescued</span><span class="o">=</span><span class="m">0</span>    <span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</code></pre></div>
<h6 id="manual-approach">Manual approach<a class="headerlink" href="#manual-approach" title="Permanent link">&para;</a></h6>
<p>On your DHCP server, create configuration for all your devices. Below is an example for isc-dhcpd server.</p>
<div class="highlight"><pre><span></span><code>$ vi /etc/dhcp/dhcpd.conf

subnet <span class="m">10</span>.255.0.0 netmask <span class="m">255</span>.255.255.0 <span class="o">{</span>
    range <span class="m">10</span>.255.0.200 <span class="m">10</span>.255.0.250<span class="p">;</span>
    option routers <span class="m">10</span>.255.0.1<span class="p">;</span>
    option domain-name-servers <span class="m">10</span>.83.28.52, <span class="m">10</span>.83.29.222<span class="p">;</span>
    option bootfile-name <span class="s2">&quot;http://10.255.0.1/ztp/bootstrap&quot;</span><span class="p">;</span>
<span class="o">}</span>

host DC1-SPINE1 <span class="o">{</span>
    option host-name <span class="s2">&quot;DC1-SPINE1&quot;</span><span class="p">;</span>
    hardware ethernet 0c:1d:c0:1d:62:01<span class="p">;</span>
    fixed-address <span class="m">10</span>.255.0.11<span class="p">;</span>
    option bootfile-name <span class="s2">&quot;http://10.255.0.1/ztp/bootstrap&quot;</span><span class="p">;</span>
<span class="o">}</span>

<span class="o">[</span>...<span class="o">]</span>
</code></pre></div>
<blockquote>
<p>Be sure to update ethernet address to match MAC addresses configured on your switches.</p>
</blockquote>
<p>Then, restart your DHCP server:</p>
<div class="highlight"><pre><span></span><code>$ service dhcpd restart
</code></pre></div>
<p>From here, you can start your devices and let CVP register them into <code>undefined</code> container.</p>
<h5 id="update-inventory">Update Inventory<a class="headerlink" href="#update-inventory" title="Permanent link">&para;</a></h5>
<p>In the <strong><code>inventory/inventory.yml</code></strong>, update CloudVision information to target your own setup:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># inventory.yml</span><span class="w"></span>
<span class="nt">all</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">children</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">CVP</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">hosts</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">ztp</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="w">        </span><span class="nt">cvp</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_httpapi_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.83.28.164</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible</span><span class="w"></span>
<span class="p p-Indicator">[</span><span class="nv">...</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_httpapi_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span><span class="w"></span>
<span class="w">          </span><span class="c1"># Configuration to get Virtual Env information</span><span class="w"></span>
<span class="w">          </span><span class="nt">ansible_python_interpreter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">$(which python)</span><span class="w"></span>
</code></pre></div>
<p>Because Ansible will never connect to devices, there is no reason to configure IP address for EOS devices in inventory file.</p>
<h5 id="update-fabric-information">Update Fabric information<a class="headerlink" href="#update-fabric-information" title="Permanent link">&para;</a></h5>
<blockquote>
<p>If you do not change IP addresses described above, this section is optional.</p>
</blockquote>
<p><strong>Edit <code>DC1_FABRIC.yml</code></strong></p>
<ul>
<li>Add / Remove devices in the list.</li>
<li>Management IP of every device.</li>
</ul>
<p>In this example, we only use <code>spine</code> and <code>l3leafs</code> devices. Below is an example for <code>l3leafs</code>:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">node_groups</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">DC1_LEAF1</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65101</span><span class="w"></span>
<span class="w">      </span><span class="nt">nodes</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">DC1-LEAF1A</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w"></span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.13/24</span><span class="w"></span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet1</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">        </span><span class="nt">DC1-LEAF1B</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"></span>
<span class="w">          </span><span class="nt">mgmt_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.14/24</span><span class="w"></span>
<span class="w">          </span><span class="nt">spine_interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">Ethernet2</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>
<p>You can also configure additional configlets available on Cloudvision to deploy additional configuration not generated by AVD project. These configlets <strong>MUST</strong> already be configured on CV side prior to run playbook.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># List of additional CVP configlets to bind to devices and containers</span><span class="w"></span>
<span class="c1"># Configlets MUST be configured on CVP before running AVD playbooks.</span><span class="w"></span>
<span class="nt">cv_configlets</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">DC1_L3LEAFS</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASE_GLOBAL-ALIASES</span><span class="w"></span>
<span class="w">  </span><span class="nt">devices</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">DC1-L2LEAF1A</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASE_DEVICE-ALIASES.conf</span><span class="w"></span>
</code></pre></div>
<p><strong>Edit <code>DC1.yml</code></strong></p>
<ul>
<li>Manage your username. Configured username and password are:<ul>
<li>admin / arista123</li>
<li>cvpdamin / arista123</li>
<li>ansible / ansible</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># local users</span><span class="w"></span>
<span class="nt">local_users</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">admin</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">privilege</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span><span class="w"></span>
<span class="w">    </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-admin</span><span class="w"></span>
<span class="w">    </span><span class="nt">sha512_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$6$Df86...&quot;</span><span class="w"></span>
</code></pre></div>
<p>You must use same user on CVP and EOS for the demo.</p>
<ul>
<li>Update Ingest key. Default setup is none.</li>
<li>Update CVP IP address.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Cloud Vision server information</span><span class="w"></span>
<span class="nt">cvp_instance_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.255.0.1</span><span class="w"></span>
<span class="nt">cvp_ingestauth_key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"></span>
</code></pre></div>
<h4 id="demo-script">Demo script<a class="headerlink" href="#demo-script" title="Permanent link">&para;</a></h4>
<h5 id="power-up-devices">Power up devices<a class="headerlink" href="#power-up-devices" title="Permanent link">&para;</a></h5>
<p>Power up your devices what ever the solution is. You will see them in the <strong><code>undefined</code></strong> container</p>
<p><img alt="ZTP Registration" src="../_media/cloudvision-ztpd-devices.png" /></p>
<h6 id="check-there-is-no-container">Check there is no container<a class="headerlink" href="#check-there-is-no-container" title="Permanent link">&para;</a></h6>
<p><img alt="Streaming Inventory" src="../_media/streaming-inventory.png" /></p>
<h6 id="check-configlets-are-not-present">Check Configlets are not present<a class="headerlink" href="#check-configlets-are-not-present" title="Permanent link">&para;</a></h6>
<p><img alt="Configlets" src="../_media/cloudvision-initial-configlet.png" /></p>
<blockquote>
<p>CloudVision might have some configlets, but none with AVD related content.</p>
</blockquote>
<h5 id="upload-custom-configlets-to-cloudvision">Upload custom configlets to Cloudvision.<a class="headerlink" href="#upload-custom-configlets-to-cloudvision" title="Permanent link">&para;</a></h5>
<p>These configlets are managed outside of AVD project and can provide additional elements not generated by Arista Validated Design. In this example, we upload a configlet with a list of useful aliases.</p>
<div class="highlight"><pre><span></span><code>$ ansible-playbook playbooks/dc1-upload-configlets.yml
...
</code></pre></div>
<p><img alt="Uploaded Configlets" src="../_media/cloudvision-uploaded-configlets.png" /></p>
<h5 id="run-ansible-playbook-to-rollout-evpn-fabric">Run Ansible playbook to rollout EVPN Fabric<a class="headerlink" href="#run-ansible-playbook-to-rollout-evpn-fabric" title="Permanent link">&para;</a></h5>
<p>A set of tags are available, but it is recommended to execute playbook in a row:</p>
<h6 id="playbook-overview">Playbook overview<a class="headerlink" href="#playbook-overview" title="Permanent link">&para;</a></h6>
<p>Playbook: <a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/blob/master/playbooks/dc1-fabric-deploy-cvp.yml"><code>playbooks/dc1-fabric-deploy-cvp.yml</code></a></p>
<p>Playbook manage following actions:</p>
<ul>
<li>Generate Variables for CVP structure:<ul>
<li>List of configlets</li>
<li>Containers topology</li>
<li>List of devices.</li>
</ul>
</li>
<li>Collect CloudVision Facts</li>
<li>Deploy Configlets to CloudVision</li>
<li>Build Containers Topology</li>
<li>Configure devices with correct configlet and container.</li>
<li>Execute created tasks (wait 5 minutes while devices reboot)</li>
</ul>
<p>This playbook supports 2 tags to run demo step by step:</p>
<ul>
<li><strong>build</strong>: Generate configuration.</li>
<li><strong>provision</strong>: Push content to CloudVision.</li>
</ul>
<h6 id="run-playbook">Run Playbook<a class="headerlink" href="#run-playbook" title="Permanent link">&para;</a></h6>
<h6 id="generate-eos-configuration">Generate EOS Configuration<a class="headerlink" href="#generate-eos-configuration" title="Permanent link">&para;</a></h6>
<p>Use tag <code>build</code> to only generate</p>
<ul>
<li><a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/tree/master/inventory/intended/structured_configs">EOS structured configuration(YAML)</a></li>
<li><a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/tree/master/inventory/intended/configs">EOS configuration</a></li>
<li><a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/tree/master/inventory/documentation/">EOS Documentation</a></li>
<li><a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/tree/master/inventory/intended/structured_configs/cvp/cv_server.yml">CloudVision parameters</a></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Deploy EVPN/VXLAN Fabric</span>
$ ansible-playbook playbooks/dc1-fabric-deploy-cvp.yml --tags build

TASK <span class="o">[</span>eos_designs : Include device structured configuration, that was previously generated.<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE2 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1B -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2B -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_designs : Generate EVPN fabric documentation <span class="k">in</span> Markdown Format.<span class="o">]</span>
changed: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_designs : Generate Leaf and Spine Point-To-Point Links summary <span class="k">in</span> csv format.<span class="o">]</span>
changed: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_designs : Generate Fabric Topology <span class="k">in</span> csv format.<span class="o">]</span>
changed: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_cli_config_gen : include device intended structure configuration variables<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE2 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1B -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2B -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_cli_config_gen : Generate eos intended configuration<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1A -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF2B -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-SPINE2 -&gt; localhost<span class="o">]</span>
ok: <span class="o">[</span>DC1-LEAF1B -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_cli_config_gen : Generate device documentation<span class="o">]</span>
changed: <span class="o">[</span>DC1-SPINE1 -&gt; localhost<span class="o">]</span>
changed: <span class="o">[</span>DC1-LEAF1A -&gt; localhost<span class="o">]</span>
changed: <span class="o">[</span>DC1-LEAF2A -&gt; localhost<span class="o">]</span>
changed: <span class="o">[</span>DC1-SPINE2 -&gt; localhost<span class="o">]</span>
changed: <span class="o">[</span>DC1-LEAF1B -&gt; localhost<span class="o">]</span>
changed: <span class="o">[</span>DC1-LEAF2B -&gt; localhost<span class="o">]</span>

PLAY <span class="o">[</span>Configuration deployment with CVP<span class="o">]</span>

TASK <span class="o">[</span>eos_config_deploy_cvp : generate intented variables<span class="o">]</span>
ok: <span class="o">[</span>cv_server<span class="o">]</span>

TASK <span class="o">[</span>eos_config_deploy_cvp : Build DEVICES and CONTAINER definition <span class="k">for</span> cv_server<span class="o">]</span>
changed: <span class="o">[</span>cv_server -&gt; localhost<span class="o">]</span>

TASK <span class="o">[</span>eos_config_deploy_cvp : Load CVP device information <span class="k">for</span> cv_server<span class="o">]</span>
ok: <span class="o">[</span>cv_server<span class="o">]</span>

PLAY RECAP
DC1-LEAF1A                 : <span class="nv">ok</span><span class="o">=</span><span class="m">5</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
DC1-LEAF1B                 : <span class="nv">ok</span><span class="o">=</span><span class="m">5</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
DC1-LEAF2A                 : <span class="nv">ok</span><span class="o">=</span><span class="m">5</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
DC1-LEAF2B                 : <span class="nv">ok</span><span class="o">=</span><span class="m">5</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
DC1-SPINE1                 : <span class="nv">ok</span><span class="o">=</span><span class="m">8</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">4</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
DC1-SPINE2                 : <span class="nv">ok</span><span class="o">=</span><span class="m">5</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
cv_server                  : <span class="nv">ok</span><span class="o">=</span><span class="m">3</span>    <span class="nv">changed</span><span class="o">=</span><span class="m">1</span>    <span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span>    <span class="nv">failed</span><span class="o">=</span><span class="m">0</span> ...
</code></pre></div>
<p>All outputs are part of following folders:</p>
<ul>
<li>Intended YAML configuration: <strong><code>inventory/intended/structured_configs</code></strong></li>
<li>Intended EOS configuration files: <strong><code>inventory/intended/configs</code></strong></li>
<li>Documentation: <strong><code>inventory/documentation</code></strong></li>
</ul>
<h6 id="provision-cloudvision-server">Provision CloudVision Server<a class="headerlink" href="#provision-cloudvision-server" title="Permanent link">&para;</a></h6>
<p>Use tag <code>provision</code> to deploy configuration to CloudVision and prepare devices to be updated:</p>
<ul>
<li>Create configlets on CloudVision servers</li>
<li>Create containers on CloudVision using inventory structure</li>
<li>Move devices to containers</li>
<li>Attach configlets to devices.</li>
</ul>
<p>This tag does not execute any pending tasks. It is a manual action that can be done with a Change Control.
If you want to automatically deploy, just use <code>execute_tasks: True</code> in <code>eos_config_deploy_cvp</code> role.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Deploy EVPN/VXLAN Fabric</span>
$ ansible-playbook playbooks/dc1-fabric-deploy-cvp.yml --tags provision
</code></pre></div>
<h6 id="execute-pending-tasks-using-a-change-control">Execute Pending tasks using a change control<a class="headerlink" href="#execute-pending-tasks-using-a-change-control" title="Permanent link">&para;</a></h6>
<p>Go to <em>Provisioning &gt; Change Control</em> to create a new change control</p>
<p><img alt="Change Control Example" src="../_media/figure-2-cloudvision-change-control.png" /></p>
<p>This change control is an example and you are free to build structure you want. In this scenario, all tasks can be run in parallel as we just rollout an EVPN/VXLAN fabric.</p>
<h4 id="analyze-result">Analyze result<a class="headerlink" href="#analyze-result" title="Permanent link">&para;</a></h4>
<p>Once devices rebooted, you can review fabric status on devices themselfs or on on CloudVision as well.</p>
<h6 id="topology-update">Topology Update<a class="headerlink" href="#topology-update" title="Permanent link">&para;</a></h6>
<p>Topology has been updated accordingly</p>
<p><img alt="Lab Topology" src="../_media/cloudvision-device-topology.png" /></p>
<h6 id="configlet-list">Configlet list<a class="headerlink" href="#configlet-list" title="Permanent link">&para;</a></h6>
<p>A set of new configlets have been configured on CloudVision and attached to devices</p>
<p><img alt="Lab Topology" src="../_media/cloudvision-deployed-configlet.png" /></p>
<h6 id="check-device-status">Check device status<a class="headerlink" href="#check-device-status" title="Permanent link">&para;</a></h6>
<p>To validate deployment, connect to devices and issue some commands:</p>
<h6 id="bgp-status">BGP Status<a class="headerlink" href="#bgp-status" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>DC1-LEAF1B#show bgp evpn summary
BGP summary information <span class="k">for</span> VRF default
Router identifier <span class="m">192</span>.168.255.4, <span class="nb">local</span> AS number <span class="m">65101</span>
Neighbor         V  AS           MsgRcvd   MsgSent  InQ OutQ  Up/Down State   PfxRcd PfxAcc
  <span class="m">192</span>.168.255.1    <span class="m">4</span>  <span class="m">65001</span>             <span class="m">56</span>        <span class="m">66</span>    <span class="m">0</span>    <span class="m">0</span> <span class="m">00</span>:00:36 Estab   <span class="m">86</span>     <span class="m">86</span>
  <span class="m">192</span>.168.255.2    <span class="m">4</span>  <span class="m">65001</span>             <span class="m">55</span>        <span class="m">39</span>    <span class="m">0</span>    <span class="m">0</span> <span class="m">00</span>:00:44 Estab   <span class="m">86</span>     <span class="m">86</span>
</code></pre></div>
<h6 id="vxlan-address-table">VXLAN address table<a class="headerlink" href="#vxlan-address-table" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>DC1-LEAF1B#show vxlan  address-table
          Vxlan Mac Address Table
----------------------------------------------------------------------

VLAN  Mac Address     Type     Prt  VTEP             Moves   Last Move
----  -----------     ----     ---  ----             -----   ---------
<span class="m">1191</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:04 ago
<span class="m">1192</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:02 ago
<span class="m">1193</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:04 ago
<span class="m">1194</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:02 ago
<span class="m">1195</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:02 ago
<span class="m">1196</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:02 ago
<span class="m">1197</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:04 ago
<span class="m">1198</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:04 ago
<span class="m">1199</span>  0e1d.c07f.d96c  EVPN     Vx1  <span class="m">192</span>.168.254.5    <span class="m">1</span>       <span class="m">0</span>:00:02 ago
Total Remote Mac Addresses <span class="k">for</span> this criterion: <span class="m">9</span>
</code></pre></div>
<h6 id="check-device-connectivity">Check device connectivity<a class="headerlink" href="#check-device-connectivity" title="Permanent link">&para;</a></h6>
<p>Connect on server 01 and issue a ping to server 02.</p>
<div class="highlight"><pre><span></span><code>root@Server01:~# ping <span class="m">10</span>.1.10.12 -c <span class="m">5</span>
PING <span class="m">10</span>.1.10.12 <span class="o">(</span><span class="m">10</span>.1.10.12<span class="o">)</span> <span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span> bytes of ../_media.
<span class="m">64</span> bytes from <span class="m">10</span>.1.10.12: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span><span class="m">0</span>.033 ms
<span class="m">64</span> bytes from <span class="m">10</span>.1.10.12: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span><span class="m">0</span>.026 ms
<span class="m">64</span> bytes from <span class="m">10</span>.1.10.12: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span><span class="m">0</span>.021 ms
<span class="m">64</span> bytes from <span class="m">10</span>.1.10.12: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span><span class="m">0</span>.026 ms
<span class="m">64</span> bytes from <span class="m">10</span>.1.10.12: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">5</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span><span class="m">0</span>.034 ms

--- <span class="m">10</span>.1.10.12 ping statistics ---
<span class="m">5</span> packets transmitted, <span class="m">5</span> received, <span class="m">0</span>% packet loss, <span class="nb">time</span> 3998ms
rtt min/avg/max/mdev <span class="o">=</span> <span class="m">0</span>.021/0.028/0.034/0.004 ms
</code></pre></div>
<h5 id="revert-topology">Revert topology<a class="headerlink" href="#revert-topology" title="Permanent link">&para;</a></h5>
<p>Once demo is over, you can revert to previous stage:</p>
<ul>
<li>Reset devices to ZTP mode (Only devices part of the demo)</li>
<li>Remove configlet deployed previously</li>
<li>Remove dedicated container topology</li>
<li>Reboot devices</li>
</ul>
<p>Playbook: <a href="https://github.com/arista-netdevops-community/ansible-avd-cloudvision-demo/blob/master/playbooks/dc1-fabric-reset-cvp.yml"><code>dc1-fabric-reset-cvp.yml</code></a></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Reset EVPN/VXLAN Fabric tp ZTP</span>
$ ansible-playbook playbooks/dc1-fabric-reset-cvp.yml
</code></pre></div>
<blockquote>
<p>Revert will reset all devices to Factory default and ZTP mode !</p>
</blockquote>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 22, 2021</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="first-project.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Build your first AVD project" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Build your first AVD project
            </div>
          </div>
        </a>
      
      
        
        <a href="lab-with-nat.html" class="md-footer__link md-footer__link--next" aria-label="Next: Use NAT to access eAPI" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Use NAT to access eAPI
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2021 Arista Networks
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../stylesheets/tables.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
      
        <script src="../stylesheets/highlight.js"></script>
      
    
  </body>
</html>